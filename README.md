# MP Dashboard ‚Äî Wildberries + Ozon (FBO)

–ú–∏–Ω–∏-–ø–æ—Ä—Ç–∞–ª –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–æ Wildberries –∏ Ozon.

## ‚ú® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- **üìä –û–±—â–∞—è —Å–≤–æ–¥–∫–∞**: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –Ω–∞ —Å–∫–ª–∞–¥–∞—Ö, –∑–∞–∫–∞–∑–∞–º –∏ –≤—ã–∫—É–ø–∞–º –∑–∞ —Å–µ–≥–æ–¥–Ω—è.
- **üíº –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤**: –î–∞–Ω–Ω—ã–µ —Å–æ –≤—Å–µ—Ö –≤–∞—à–∏—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ Ozon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è.
- **üì¶ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ç–æ–≤–∞—Ä–∞–º (SKU)**:
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –¥–≤–∏–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ (–≤ –ø—É—Ç–∏ –∫ –∫–ª–∏–µ–Ω—Ç—É/–æ—Ç –∫–ª–∏–µ–Ω—Ç–∞) –ø–æ –∫–∞–∂–¥–æ–º—É SKU.
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ **–∞–ª–∏–∞—Å—ã** –∏ –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤.
- **üñ±Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–æ–≤ –∏ –≤—ã–∫—É–ø–æ–≤**: –†–∞—Å–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è —Å–ø–∏—Å–∫–∏ –≤ –ø–ª–∏—Ç–∫–∞—Ö "–ó–∞–∫–∞–∑–∞–Ω–æ —Å–µ–≥–æ–¥–Ω—è" –∏ "–í—ã–∫—É–ø–ª–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è" —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤—Ä–µ–º–µ–Ω–∏, –≥–æ—Ä–æ–¥–µ –∏ —Å–∫–ª–∞–¥–µ –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.
- **‚ö° –£–º–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç (–≤ `:00` –∏ `:30` –º–∏–Ω—É—Ç —á–∞—Å–∞) –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **–ë—ç–∫–µ–Ω–¥**: Python 3.12, Flask, Gunicorn
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: Flask-Caching (—Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: Pydantic
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: Bootstrap 5 (Bootswatch), JavaScript
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä**: Nginx (–≤ –∫–∞—á–µ—Å—Ç–≤–µ reverse proxy)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone <URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>
cd mp-dashboard
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

#### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (`mp-dashboard/.env`) –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞ `.env.example`.

```bash
cp -n .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env` –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
```env
# Wildberries API —Ç–æ–∫–µ–Ω
WB_API_TOKEN=...

# Ozon ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
# –î–ª—è –ø–µ—Ä–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞:
OZON_CLIENT_ID_1=...
OZON_API_KEY_1=...
OZON_SKUS_1=123456,789012 # (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤)

# –î–ª—è –≤—Ç–æ—Ä–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ (–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö):
OZON_CLIENT_ID_2=...
OZON_API_KEY_2=...
OZON_SKUS_2=...

# –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
TIMEZONE=Europe/Moscow
SECRET_KEY=super-secret-key-for-flask
```

#### 4. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é:
```bash
# –ß–µ—Ä–µ–∑ Gunicorn (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
gunicorn --workers 2 --bind 127.0.0.1:8001 wsgi:app

# –ò–ª–∏ —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä Flask (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
python wsgi.py
```
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–∞—à–±–æ—Ä–¥ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://127.0.0.1:8001/`.

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Production)

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º `systemd` –∏ `Nginx`.

- **systemd**: –Æ–Ω–∏—Ç-—Ñ–∞–π–ª `mp-dashboard.service` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Gunicorn-—Å–µ—Ä–≤–µ—Ä–∞.
- **Nginx**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è reverse proxy (`:80` ‚Üí `127.0.0.1:8001`) –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `/etc/nginx/sites-available/`.

–ü—Ä–∏–º–µ—Ä —é–Ω–∏—Ç–∞ `systemd` (`/etc/systemd/system/mp-dashboard.service`):
```ini
[Unit]
Description=MP Dashboard (Flask) via Gunicorn
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/mp-dashboard
ExecStart=/root/mp-dashboard/.venv/bin/gunicorn --workers 3 --bind 127.0.0.1:8001 wsgi:app
Restart=always
RestartSec=3

[Install]
WantedBy=multi-user.target
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –º–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–ª–æ—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `pytest`. –¢–µ—Å—Ç—ã **–Ω–µ –¥–µ–ª–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–æ–∫–∏), –ø–æ—ç—Ç–æ–º—É –∏—Ö –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ.

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
# (–∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ .venv, –µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–ª–∏)
pip install pytest
```

#### 2. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```bash
pytest
```

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏:
- `app/routes`: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã).
- `app/services`: –õ–æ–≥–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API (WB, Ozon).
- `app/presenters`: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —à–∞–±–ª–æ–Ω–∞—Ö.
- `app/schemas`: Pydantic-—Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ API.
- `app/utils`: –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã (–∞–ª–∏–∞—Å—ã SKU, –ª–æ–≥–∏–∫–∞ –∫—ç—à–∞).
- `app/templates`: Jinja2-—à–∞–±–ª–æ–Ω—ã.

#### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Flask-Caching` —Å —Ñ–∞–π–ª–æ–≤—ã–º –±—ç–∫–µ–Ω–¥–æ–º, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±—â–∏–π –∫—ç—à –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Gunicorn.
- **–¢–∞–π–º–∞—É—Ç –∫—ç—à–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π**: –û–Ω —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ–±—ã —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è —Ä–æ–≤–Ω–æ –≤ `:00` –∏ `:30` –º–∏–Ω—É—Ç –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞ –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏.
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ URL `/?force=1`.

#### –ê–ª–∏–∞—Å—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ SKU
–ù–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ (SKU) –º–æ–≥—É—Ç –±—ã—Ç—å –¥–ª–∏–Ω–Ω—ã–º–∏ –∏ –Ω–µ—É–¥–æ–±–Ω—ã–º–∏. –í `app/utils/sku_aliases.py` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ **–∞–ª–∏–∞—Å—ã**, –∞ —Ç–∞–∫–∂–µ –∑–∞–¥–∞—Ç—å **–ø–æ—Ä—è–¥–æ–∫ –∏—Ö –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è** –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ.
